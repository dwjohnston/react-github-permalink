"use strict";(self.webpackChunkreact_github_permalink=self.webpackChunkreact_github_permalink||[]).push([[816],{"./src/library/GithubPermalink/GithubPermalink.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{CustomDataFn:()=>CustomDataFn,ErrorReporting:()=>ErrorReporting,LongPath:()=>LongPath,Primary:()=>Primary,SingleLine:()=>SingleLine,WithBackground:()=>WithBackground,WithToken:()=>WithToken,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),_GithubPermalink__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/library/GithubPermalink/GithubPermalink.tsx"),_config_GithubPermalinkContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/library/config/GithubPermalinkContext.tsx"),console=(__webpack_require__("./src/library/GithubPermalink/github-permalink.css"),__webpack_require__("./node_modules/console-browserify/index.js")),process=__webpack_require__("./node_modules/process/browser.js");const __WEBPACK_DEFAULT_EXPORT__={component:_GithubPermalink__WEBPACK_IMPORTED_MODULE_1__.T},Primary={render:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_GithubPermalink__WEBPACK_IMPORTED_MODULE_1__.T,{permalink:"https://github.com/dwjohnston/react-github-permalink/blob/5b15aa07e60af4e317086f391b28cadf9aae8e1b/sample_files/sample1.go#L1-L5"})},WithBackground={render:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{backgroundColor:"pink",padding:"1em"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_GithubPermalink__WEBPACK_IMPORTED_MODULE_1__.T,{permalink:"https://github.com/dwjohnston/react-github-permalink/blob/5b15aa07e60af4e317086f391b28cadf9aae8e1b/sample_files/sample1.go#L1-L5"})})},CustomDataFn={render:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_config_GithubPermalinkContext__WEBPACK_IMPORTED_MODULE_2__.W,{getDataFn:permalink=>Promise.resolve({lines:["a","b"],lineFrom:1,lineTo:2,commit:"123",path:"something",owner:"fooby",repo:"repo",commitUrl:"https://example.com",status:"ok"}),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_GithubPermalink__WEBPACK_IMPORTED_MODULE_1__.T,{permalink:"https://github.com/djohnston/react-github-permalink/blob/5b15aa07e60af4e317086f391b28cadf9aae8e1b/sample_files/sample1.go#L1-L5"})})},ErrorReporting={render:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_config_GithubPermalinkContext__WEBPACK_IMPORTED_MODULE_2__.W,{onError:err=>console.error(err),children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_GithubPermalink__WEBPACK_IMPORTED_MODULE_1__.T,{permalink:"https://github.com/djohnston/react-github-permalink/blob/5b15aa07e60af4e317086f391b28cadf9aae8e1b/sample_files/sample1.go#L1-L5"})})},WithToken={render:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_config_GithubPermalinkContext__WEBPACK_IMPORTED_MODULE_2__.W,{githubToken:process.env.STORYBOOK_GITHUB_TOKEN,children:[" ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_GithubPermalink__WEBPACK_IMPORTED_MODULE_1__.T,{permalink:"https://github.com/dwjohnston/react-github-permalink/blob/5b15aa07e60af4e317086f391b28cadf9aae8e1b/sample_files/sample1.go#L1-L5"})]})},LongPath={render:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{style:{width:410,color:"solid 1px red"},children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_config_GithubPermalinkContext__WEBPACK_IMPORTED_MODULE_2__.W,{githubToken:process.env.STORYBOOK_GITHUB_TOKEN,children:[" ",(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_GithubPermalink__WEBPACK_IMPORTED_MODULE_1__.T,{permalink:"https://github.com/dwjohnston/blacksheepcode/blob/24c6f3ef9d09f9e061226e19e78a4c8d1ee03710/app/routes/posts/adding_msw_bundler_to_remix_app_2.mdx#L1-L11"})]})})},SingleLine={render:()=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_GithubPermalink__WEBPACK_IMPORTED_MODULE_1__.T,{permalink:"https://github.com/dwjohnston/blacksheepcode/blob/72ee472bfa896df255ae42ef017ad0cca96b2333/app/components/PostComments/PostComments.tsx#L28"})},__namedExportsOrder=["Primary","WithBackground","CustomDataFn","ErrorReporting","WithToken","LongPath","SingleLine"];Primary.parameters={...Primary.parameters,docs:{...Primary.parameters?.docs,source:{originalSource:'{\n  render: () => <GithubPermalink permalink="https://github.com/dwjohnston/react-github-permalink/blob/5b15aa07e60af4e317086f391b28cadf9aae8e1b/sample_files/sample1.go#L1-L5" />\n}',...Primary.parameters?.docs?.source}}},WithBackground.parameters={...WithBackground.parameters,docs:{...WithBackground.parameters?.docs,source:{originalSource:'{\n  render: () => <div style={{\n    backgroundColor: "pink",\n    padding: "1em"\n  }}>\n      <GithubPermalink permalink="https://github.com/dwjohnston/react-github-permalink/blob/5b15aa07e60af4e317086f391b28cadf9aae8e1b/sample_files/sample1.go#L1-L5" />\n    </div>\n}',...WithBackground.parameters?.docs?.source}}},CustomDataFn.parameters={...CustomDataFn.parameters,docs:{...CustomDataFn.parameters?.docs,source:{originalSource:'{\n  render: () => <GithubPermalinkProvider getDataFn={permalink => {\n    return Promise.resolve({\n      lines: ["a", "b"],\n      lineFrom: 1,\n      lineTo: 2,\n      commit: "123",\n      path: "something",\n      owner: "fooby",\n      repo: "repo",\n      commitUrl: "https://example.com",\n      status: "ok"\n    });\n  }}>\n      <GithubPermalink permalink="https://github.com/djohnston/react-github-permalink/blob/5b15aa07e60af4e317086f391b28cadf9aae8e1b/sample_files/sample1.go#L1-L5" />\n    </GithubPermalinkProvider>\n}',...CustomDataFn.parameters?.docs?.source}}},ErrorReporting.parameters={...ErrorReporting.parameters,docs:{...ErrorReporting.parameters?.docs,source:{originalSource:'{\n  render: () => <GithubPermalinkProvider onError={err => console.error(err)}>\n      <GithubPermalink permalink="https://github.com/djohnston/react-github-permalink/blob/5b15aa07e60af4e317086f391b28cadf9aae8e1b/sample_files/sample1.go#L1-L5" />\n    </GithubPermalinkProvider>\n}',...ErrorReporting.parameters?.docs?.source}}},WithToken.parameters={...WithToken.parameters,docs:{...WithToken.parameters?.docs,source:{originalSource:'{\n  render: () => <GithubPermalinkProvider githubToken={process.env.STORYBOOK_GITHUB_TOKEN}>\n      {" "}\n      <GithubPermalink permalink="https://github.com/dwjohnston/react-github-permalink/blob/5b15aa07e60af4e317086f391b28cadf9aae8e1b/sample_files/sample1.go#L1-L5" />\n    </GithubPermalinkProvider>\n}',...WithToken.parameters?.docs?.source}}},LongPath.parameters={...LongPath.parameters,docs:{...LongPath.parameters?.docs,source:{originalSource:'{\n  render: () => <div style={{\n    width: 410,\n    color: "solid 1px red"\n  }}>\n      <GithubPermalinkProvider githubToken={process.env.STORYBOOK_GITHUB_TOKEN}>\n        {" "}\n        <GithubPermalink permalink="https://github.com/dwjohnston/blacksheepcode/blob/24c6f3ef9d09f9e061226e19e78a4c8d1ee03710/app/routes/posts/adding_msw_bundler_to_remix_app_2.mdx#L1-L11" />\n      </GithubPermalinkProvider>\n    </div>\n}',...LongPath.parameters?.docs?.source}}},SingleLine.parameters={...SingleLine.parameters,docs:{...SingleLine.parameters?.docs,source:{originalSource:'{\n  render: () => <GithubPermalink permalink="https://github.com/dwjohnston/blacksheepcode/blob/72ee472bfa896df255ae42ef017ad0cca96b2333/app/components/PostComments/PostComments.tsx#L28" />\n}',...SingleLine.parameters?.docs?.source}}}},"./src/library/GithubPermalink/GithubPermalink.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{T:()=>GithubPermalink});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_config_GithubPermalinkContext__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/library/config/GithubPermalinkContext.tsx"),_GithubPermalinkBase__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/library/GithubPermalink/GithubPermalinkBase.tsx");function GithubPermalink(props){const{permalink}=props,[data,setData]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),{getDataFn,githubToken,onError}=(0,react__WEBPACK_IMPORTED_MODULE_1__.useContext)(_config_GithubPermalinkContext__WEBPACK_IMPORTED_MODULE_2__.C),[isLoading,setIsLoading]=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!0);if((0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((()=>{getDataFn(permalink,githubToken,onError).then((v=>{setIsLoading(!1),setData(v)}))}),[getDataFn,githubToken,onError,permalink]),isLoading)return null;if(!data)throw new Error("Loading is complete, but no data was returned.");return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_GithubPermalinkBase__WEBPACK_IMPORTED_MODULE_3__.I,{data,...props})}try{GithubPermalink.displayName="GithubPermalink",GithubPermalink.__docgenInfo={description:"",displayName:"GithubPermalink",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},permalink:{defaultValue:null,description:"",name:"permalink",required:!0,type:{name:"string"}},excludeLines:{defaultValue:null,description:"",name:"excludeLines",required:!1,type:{name:"[from: number, to: number][]"}},excludeText:{defaultValue:null,description:"",name:"excludeText",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/library/GithubPermalink/GithubPermalink.tsx#GithubPermalink"]={docgenInfo:GithubPermalink.__docgenInfo,name:"GithubPermalink",path:"src/library/GithubPermalink/GithubPermalink.tsx#GithubPermalink"})}catch(__react_docgen_typescript_loader_error){}},"./src/library/GithubPermalink/GithubPermalinkBase.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{I:()=>GithubPermalinkBase});var jsx_runtime=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),ErrorMessages=__webpack_require__("./src/library/ErrorMessages/ErrorMessages.tsx"),GithubSvg=__webpack_require__("./src/library/GithubSvg/GithubSvg.tsx"),default_highlight=__webpack_require__("./node_modules/react-syntax-highlighter/dist/esm/default-highlight.js"),hljs=__webpack_require__("./node_modules/react-syntax-highlighter/dist/cjs/styles/hljs/index.js"),esm=__webpack_require__("./node_modules/react-responsive/dist/esm/index.js"),react=__webpack_require__("./node_modules/next/dist/compiled/react/index.js");const noTheme={hljs:{display:"block",overflowX:"auto",padding:"0.5em",color:"inherit",background:"inherit"},"hljs-comment":{color:"inherit",fontStyle:"italic"},"hljs-quote":{color:"inherit",fontStyle:"italic"},"hljs-keyword":{color:"inherit",fontWeight:"bold"},"hljs-selector-tag":{color:"inherit",fontWeight:"bold"},"hljs-subst":{color:"inherit",fontWeight:"normal"},"hljs-number":{color:"inherit"},"hljs-literal":{color:"inherit"},"hljs-variable":{color:"inherit"},"hljs-template-variable":{color:"inherit"},"hljs-tag .hljs-attr":{color:"inherit"},"hljs-string":{color:"inherit"},"hljs-doctag":{color:"inherit"},"hljs-title":{color:"inherit",fontWeight:"bold"},"hljs-section":{color:"inherit",fontWeight:"bold"},"hljs-selector-id":{color:"inherit",fontWeight:"bold"},"hljs-type":{color:"inherit",fontWeight:"bold"},"hljs-class .hljs-title":{color:"inherit",fontWeight:"bold"},"hljs-tag":{color:"inherit",fontWeight:"normal"},"hljs-name":{color:"inherit",fontWeight:"normal"},"hljs-attribute":{color:"inherit",fontWeight:"normal"},"hljs-regexp":{color:"inherit"},"hljs-link":{color:"inherit"},"hljs-symbol":{color:"inherit"},"hljs-bullet":{color:"inherit"},"hljs-built_in":{color:"inherit"},"hljs-builtin-name":{color:"inherit"},"hljs-meta":{color:"inherit",fontWeight:"bold"},"hljs-deletion":{background:"inherit"},"hljs-addition":{background:"inherit"},"hljs-emphasis":{fontStyle:"italic"},"hljs-strong":{fontWeight:"bold"}};function SyntaxHighlight(props){const{startingLineNumber,text,className}=props,isDarkMode=(0,esm.Ub)({query:"(prefers-color-scheme: dark)"}),[ready,setReady]=(0,react.useState)(!1);return(0,react.useEffect)((()=>{setReady(!0)}),[]),(0,jsx_runtime.jsx)(default_highlight.A,{className,style:ready?isDarkMode?hljs.sb:hljs.M:noTheme,language:"javascript",showLineNumbers:void 0!==startingLineNumber,startingLineNumber,children:text})}try{SyntaxHighlight.displayName="SyntaxHighlight",SyntaxHighlight.__docgenInfo={description:"",displayName:"SyntaxHighlight",props:{text:{defaultValue:null,description:"",name:"text",required:!0,type:{name:"string"}},startingLineNumber:{defaultValue:null,description:"",name:"startingLineNumber",required:!1,type:{name:"number"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/library/SyntaxHighlight/SyntaxHighlight.tsx#SyntaxHighlight"]={docgenInfo:SyntaxHighlight.__docgenInfo,name:"SyntaxHighlight",path:"src/library/SyntaxHighlight/SyntaxHighlight.tsx#SyntaxHighlight"})}catch(__react_docgen_typescript_loader_error){}function CopySvg(){return(0,jsx_runtime.jsxs)("svg",{viewBox:"0 0 16 16",width:"16",height:"16",style:{display:"inline-block",userSelect:"none",verticalAlign:"text-bottom",overflow:"visible"},children:[(0,jsx_runtime.jsx)("path",{d:"M0 6.75C0 5.784.784 5 1.75 5h1.5a.75.75 0 0 1 0 1.5h-1.5a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-1.5a.75.75 0 0 1 1.5 0v1.5A1.75 1.75 0 0 1 9.25 16h-7.5A1.75 1.75 0 0 1 0 14.25Z"}),(0,jsx_runtime.jsx)("path",{d:"M5 1.75C5 .784 5.784 0 6.75 0h7.5C15.216 0 16 .784 16 1.75v7.5A1.75 1.75 0 0 1 14.25 11h-7.5A1.75 1.75 0 0 1 5 9.25Zm1.75-.25a.25.25 0 0 0-.25.25v7.5c0 .138.112.25.25.25h7.5a.25.25 0 0 0 .25-.25v-7.5a.25.25 0 0 0-.25-.25Z"})]})}function TickSvg(){return(0,jsx_runtime.jsx)("svg",{"aria-hidden":"true",height:"16",viewBox:"0 0 16 16",version:"1.1",width:"16",style:{display:"inline-block",userSelect:"none",verticalAlign:"text-bottom",overflow:"visible"},children:(0,jsx_runtime.jsx)("path",{d:"M13.78 4.22a.75.75 0 0 1 0 1.06l-7.25 7.25a.75.75 0 0 1-1.06 0L2.22 9.28a.751.751 0 0 1 .018-1.042.751.751 0 0 1 1.042-.018L6 10.94l6.72-6.72a.75.75 0 0 1 1.06 0Z"})})}function CopyButton(props){const{clipboard}=props,idCopy=(0,react.useId)(),idCopied=(0,react.useId)(),copyRef=(0,react.useRef)(null),copiedRef=(0,react.useRef)(null),[isClicked,setIsClicked]=(0,react.useState)(!1);return(0,react.useEffect)((()=>{const timeout=setTimeout((()=>{var _copiedRef_current;setIsClicked(!1),null===(_copiedRef_current=copiedRef.current)||void 0===_copiedRef_current||_copiedRef_current.hidePopover()}),2e3);return()=>{clearTimeout(timeout)}}),[isClicked]),(0,jsx_runtime.jsxs)("div",{className:"tooltip-container",children:[(0,jsx_runtime.jsx)("div",{className:"tooltip-target",id:idCopy,popover:"auto",ref:copyRef}),(0,jsx_runtime.jsx)("div",{className:"tooltip-content",children:"Copy snippet"}),(0,jsx_runtime.jsx)("div",{className:"tooltip-target",id:idCopied,popover:"auto",ref:copiedRef}),(0,jsx_runtime.jsx)("div",{className:"tooltip-content",children:"Copied!"}),(0,jsx_runtime.jsx)("button",{className:isClicked?"clicked":"not-clicked",onMouseEnter:()=>{var _copyRef_current;isClicked||(null===(_copyRef_current=copyRef.current)||void 0===_copyRef_current||_copyRef_current.showPopover())},onMouseLeave:()=>{var _copyRef_current;null===(_copyRef_current=copyRef.current)||void 0===_copyRef_current||_copyRef_current.hidePopover()},popoverTarget:idCopied,title:"Copy snippet",onClick:()=>{navigator.clipboard.writeText(clipboard),setIsClicked(!0)},children:isClicked?(0,jsx_runtime.jsx)(TickSvg,{}):(0,jsx_runtime.jsx)(CopySvg,{})})]})}try{CopyButton.displayName="CopyButton",CopyButton.__docgenInfo={description:"",displayName:"CopyButton",props:{clipboard:{defaultValue:null,description:"",name:"clipboard",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/library/common/CopyButton/CopyButton.tsx#CopyButton"]={docgenInfo:CopyButton.__docgenInfo,name:"CopyButton",path:"src/library/common/CopyButton/CopyButton.tsx#CopyButton"})}catch(__react_docgen_typescript_loader_error){}function GithubPermalinkBase(props){const{data,permalink,excludeLines,excludeText="<snip>"}=props;if("ok"===data.status){const formatedLineExclusions=function formatForLineExclusions(input,exclusions=[]){const result=[];let currentLine=input.lineFrom;for(const exclusion of exclusions){const[exclusionFrom,exclusionTo]=exclusion;currentLine<exclusionFrom&&result.push({from:currentLine,to:exclusionFrom-1,isExclude:!1,lines:input.lines.slice(currentLine-input.lineFrom,exclusionFrom-input.lineFrom)}),result.push({from:exclusionFrom,to:exclusionTo,isExclude:!0}),currentLine=exclusionTo+1}return currentLine<=input.lineTo&&result.push({from:currentLine,to:input.lineTo,isExclude:!1,lines:input.lines.slice(currentLine-input.lineFrom,input.lineTo-input.lineFrom+1)}),result}(data,excludeLines),clipboard=formatedLineExclusions.reduce(((acc,cur)=>cur.isExclude?acc+"\n":acc+"\n"+cur.lines.join("\n")),"");return(0,jsx_runtime.jsx)(GithubPermalinkInner,{...props,clipboard,header:(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("a",{href:permalink,className:"file-link",children:`${data.owner}/${data.repo}/${data.path}`}),(0,jsx_runtime.jsxs)("p",{children:[data.lineFrom===data.lineTo?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Line ",data.lineFrom]}):(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:["Lines ",data.lineFrom," to ",data.lineTo]})," in ",(0,jsx_runtime.jsx)("a",{className:"commit-link",href:data.commitUrl,children:data.commit.slice(0,7)})]})]}),children:formatedLineExclusions.map((v=>v.isExclude?(0,jsx_runtime.jsx)(SyntaxHighlight,{className:"hide-line-numbers",text:excludeText,startingLineNumber:v.from},v.from):(0,jsx_runtime.jsx)(SyntaxHighlight,{text:v.lines.join("\n"),startingLineNumber:v.from},v.from)))})}return(0,jsx_runtime.jsx)(GithubPermalinkInner,{...props,children:(0,jsx_runtime.jsx)(ErrorMessages.f,{data})})}function GithubPermalinkInner(props){const{clipboard}=props;var _props_className,_props_header;return(0,jsx_runtime.jsxs)("div",{className:`rgp-base react-github-permalink ${null!==(_props_className=props.className)&&void 0!==_props_className?_props_className:""}`,children:[(0,jsx_runtime.jsxs)("div",{className:"header",children:[(0,jsx_runtime.jsx)("div",{children:(0,jsx_runtime.jsx)(GithubSvg.Y,{})}),(0,jsx_runtime.jsx)("div",{className:"link-wrapper",children:null!==(_props_header=props.header)&&void 0!==_props_header?_props_header:(0,jsx_runtime.jsx)("a",{href:props.permalink,className:"file-link",children:props.permalink})}),clipboard&&(0,jsx_runtime.jsx)("div",{className:"copy-button-container",children:(0,jsx_runtime.jsx)(CopyButton,{clipboard})})]}),props.children]})}try{GithubPermalinkBase.displayName="GithubPermalinkBase",GithubPermalinkBase.__docgenInfo={description:"",displayName:"GithubPermalinkBase",props:{className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},permalink:{defaultValue:null,description:"",name:"permalink",required:!0,type:{name:"string"}},excludeLines:{defaultValue:null,description:"",name:"excludeLines",required:!1,type:{name:"[from: number, to: number][]"}},excludeText:{defaultValue:null,description:"",name:"excludeText",required:!1,type:{name:"string"}},data:{defaultValue:null,description:"",name:"data",required:!0,type:{name:"GithubPermalinkDataResponse"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/library/GithubPermalink/GithubPermalinkBase.tsx#GithubPermalinkBase"]={docgenInfo:GithubPermalinkBase.__docgenInfo,name:"GithubPermalinkBase",path:"src/library/GithubPermalink/GithubPermalinkBase.tsx#GithubPermalinkBase"})}catch(__react_docgen_typescript_loader_error){}},"./src/library/config/GithubPermalinkContext.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{C:()=>GithubPermalinkContext,W:()=>GithubPermalinkProvider});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/next/dist/compiled/react/jsx-runtime.js"),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/next/dist/compiled/react/index.js"),_defaultFunctions__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/library/config/defaultFunctions.ts");const GithubPermalinkContext=(0,react__WEBPACK_IMPORTED_MODULE_1__.createContext)({getDataFn:_defaultFunctions__WEBPACK_IMPORTED_MODULE_2__.Bj,getIssueFn:_defaultFunctions__WEBPACK_IMPORTED_MODULE_2__.Nw});function GithubPermalinkProvider(props){var _props_getDataFn,_props_getIssueFn;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(GithubPermalinkContext.Provider,{value:{getDataFn:null!==(_props_getDataFn=props.getDataFn)&&void 0!==_props_getDataFn?_props_getDataFn:_defaultFunctions__WEBPACK_IMPORTED_MODULE_2__.Bj,getIssueFn:null!==(_props_getIssueFn=props.getIssueFn)&&void 0!==_props_getIssueFn?_props_getIssueFn:_defaultFunctions__WEBPACK_IMPORTED_MODULE_2__.Nw,githubToken:props.githubToken,onError:props.onError},children:props.children})}try{GithubPermalinkProvider.displayName="GithubPermalinkProvider",GithubPermalinkProvider.__docgenInfo={description:"",displayName:"GithubPermalinkProvider",props:{getDataFn:{defaultValue:null,description:"Function to provide permalink data payload",name:"getDataFn",required:!1,type:{name:"((permalink: string, githubToken?: string, onError?: ((err: unknown) => void)) => Promise<GithubPermalinkDataResponse>) | undefined"}},getIssueFn:{defaultValue:null,description:"Function to provide issue data payload",name:"getIssueFn",required:!1,type:{name:"((issueLink: string, githubToken?: string, onError?: ((err: unknown) => void)) => Promise<GithubIssueLinkDataResponse>) | undefined"}},githubToken:{defaultValue:null,description:"A github personal access token - will be passed to the data fetching functions",name:"githubToken",required:!1,type:{name:"string"}},onError:{defaultValue:null,description:"If an error occurs while fetching the data this function will be called. \nYou can use this to report to Sentry etc\n@param e\n@returns",name:"onError",required:!1,type:{name:"((e: unknown) => void)"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/library/config/GithubPermalinkContext.tsx#GithubPermalinkProvider"]={docgenInfo:GithubPermalinkProvider.__docgenInfo,name:"GithubPermalinkProvider",path:"src/library/config/GithubPermalinkContext.tsx#GithubPermalinkProvider"})}catch(__react_docgen_typescript_loader_error){}},"./src/library/config/defaultFunctions.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{async function defaultGetIssueFn(issueLink,githubToken,onError){const config=function parseGithubIssueLink(url){const match=url.match(/^https?:\/\/github\.com\/([^/]+)\/([^/]+)\/(?:issues|pull)\/(\d+)$/);if(match){const[,owner,repo,issue]=match;return{owner,repo,issue}}throw new Error("Invalid issue link URL")}(issueLink),options=githubToken?{headers:{Authorization:`Bearer ${githubToken}`}}:void 0,issueResult=await fetch(`https://api.github.com/repos/${config.owner}/${config.repo}/issues/${config.issue}`,options);if(!issueResult.ok)return null==onError||onError(issueResult),handleResponse(issueResult);const issueJson=await issueResult.json();return{issueTitle:issueJson.title,issueNumber:config.issue,issueState:issueJson.state,status:"ok",owner:config.owner,repo:config.repo,reactions:issueJson.reactions}}async function defaultGetPermalinkFn(permalink,githubToken,onError){const config=function parseGithubPermalinkUrl(githubURL){const match=githubURL.match(/https:\/\/github\.com\/([^/]+)\/([^/]+)\/blob\/([^/]+)\/(.+)#L(\d+)(?:-L(\d+))?/);if(match){const[,owner,repo,commit,path,lineFrom,lineTo]=match;return{owner,repo,commit,path,lineFrom:parseInt(lineFrom,10),lineTo:lineTo?parseInt(lineTo,10):parseInt(lineFrom,10)}}throw new Error("Invalid permalink URL")}(permalink),options=githubToken?{headers:{Authorization:`Bearer ${githubToken}`}}:void 0,contentPromise=fetch(`https://api.github.com/repos/${config.owner}/${config.repo}/contents/${config.path}?ref=${config.commit}`,options),commitPromise=fetch(`https://api.github.com/repos/${config.owner}/${config.repo}/commits/${config.commit}`,options),[contentResult,commitResult]=await Promise.all([contentPromise,commitPromise]);if(!contentResult.ok)return null==onError||onError(contentResult),handleResponse(contentResult);if(!commitResult.ok)return null==onError||onError(commitResult),handleResponse(commitResult);const[contentJson,commitJson]=await Promise.all([contentResult.json(),commitResult.json()]);return{lines:atob(contentJson.content).split("\n").slice(config.lineFrom-1,config.lineTo),lineFrom:config.lineFrom,lineTo:config.lineTo,commit:config.commit,path:config.path,owner:config.owner,repo:config.repo,commitUrl:commitJson.html_url,status:"ok"}}function handleResponse(response){return 404===response.status?{status:"404"}:403===response.status&&"0"===response.headers.get("X-Ratelimit-Remaining")?{status:"rate-limit"}:401===response.status?{status:"unauthorized"}:{status:"other-error"}}__webpack_require__.d(__webpack_exports__,{Nw:()=>defaultGetIssueFn,Bj:()=>defaultGetPermalinkFn})}}]);